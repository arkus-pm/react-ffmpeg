(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{183:function(e,t,n){e.exports=n(220)},185:function(e,t,n){},207:function(e,t,n){},220:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=(n(185),n(14)),i=n(21),l=n.n(i),c=n(31),s=n(126),u=n(7),d=n(127),f=(n(207),n(296)),m=n(290),p=n(298),v=n(281),h=n(300),g=n(299),w=(n(208),n(152)),b=n(291),y=n(287),E=n(147),x=n.n(E),P=n(232),j=n(148),k=n.n(j),O=n(149),N=n.n(O),F=function(e){var t=e.audio,n=Object(a.useRef)(),o=Object(a.useRef)({isPlaying:function(){return!1}}),i=Object(a.useState)(!1),l=Object(u.a)(i,2),c=l[0],s=l[1];return Object(a.useEffect)((function(){var e=x.a.create({container:n.current,fillParent:!1,height:50,width:200,barWidth:2,barHeight:2,cursorWidth:1});return e.loadBlob(t),e.on("ready",(function(){o.current=e,e.seekTo(1)})),function(){e.destroy()}}),[t]),r.a.createElement(f.a,{container:!0},r.a.createElement("div",{style:{display:"flex",alignItems:"center",flexDirection:"row"}},r.a.createElement(P.a,{onClick:function(){o.current.playPause(),s(o.current.isPlaying()),o.current.on("finish",(function(){s(o.current.isPlaying())}))},color:"primary"},c?r.a.createElement(k.a,null):r.a.createElement(N.a,null)),r.a.createElement("div",{style:{width:"100%"},ref:n})))},S=n(9);Object(S.a)("div")((function(e){var t=e.theme;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%","& .ant-empty-img-1":{fill:"light"===t.palette.mode?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:"light"===t.palette.mode?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:"light"===t.palette.mode?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:"light"===t.palette.mode?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:"light"===t.palette.mode?"0.8":"0.08",fill:"light"===t.palette.mode?"#f5f5f5":"#fff"}}}));var C=n(151),R=n.n(C),W=n(150),A=n.n(W),I=n(297),D=[{field:"id",headerName:"ID",flex:1,hide:!0},{headerName:"Parent Folder",sortable:!0,flex:.5,valueGetter:function(e){return e.row.relativePath.split("/").slice(-2,-1)||""}},{field:"fileName",headerName:"FileName",sortable:!0,flex:.5},{field:"relativePath",headerName:"Path",sortable:!0,flex:2,hide:!0},{field:"type",headerName:"Type",flex:.5},{field:"duration",headerName:"Duration",flex:.25,sortable:!0,type:"number",valueGetter:function(e){return e.row.metadata.duration},valueFormatter:function(e){return null==e.value?"loading...":"".concat(e.value.toFixed(2),"s")},renderCell:function(e){return null==e.row.metadata.duration?a.createElement(h.a,null):"".concat(e.row.metadata.duration.toFixed(2),"s")}},{field:"waveform",headerName:"Waveform",flex:1,renderCell:function(e){return a.createElement(F,{audio:e.row.file})}},{field:"difference",headerName:"Difference",flex:.5,renderCell:function(e){var t,n,r=(null===(t=e.row.processed)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.metadata.duration)-e.row.metadata.duration;if(r){var o=function(){return r>0?a.createElement(A.a,null):a.createElement(R.a,null)};return a.createElement(I.a,{sx:{paddingLeft:"10px"},icon:a.createElement(o,{style:{paddingLeft:"2px"}}),variant:"outlined",color:r>0?"error":"success",label:r.toFixed(2)+"s"})}}},{field:"processedDuration",headerName:"Pr. Duration",flex:.5,sortable:!0,type:"number",valueGetter:function(e){var t,n;return(null===(t=e.row.processed)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.metadata.duration)||null},valueFormatter:function(e){var t;if(null===(t=e.row)||void 0===t?void 0:t.processed)return null==e.value?"loading...":"".concat(e.value.toFixed(2),"s")},renderCell:function(e){var t;if(e.row.processed)return e.row.processed.loaded?"".concat(null===(t=e.row.processed)||void 0===t?void 0:t.result.metadata.duration.toFixed(2),"s"):a.createElement(h.a,null)}},{field:"processedFile",headerName:"Processed",flex:1,renderCell:function(e){if(e.row.processed)return e.row.processed.loaded?a.createElement("div",null,a.createElement(F,{audio:e.row.processed.result.file})):a.createElement(h.a,null)}}],L=function(e){return a.createElement("div",{style:{padding:"0 2em 0 2em"}},a.createElement("div",{style:{float:"right",display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"}},a.createElement(w.a,null)," ",a.createElement(b.a,e)))};function B(e){var t=e.rows;return a.createElement(g.a,{sx:{width:"100%"}},a.createElement(y.a,{components:{Toolbar:L},autoHeight:!0,rows:t,columns:D,pageSize:100,rowsPerPageOptions:[5],checkboxSelection:!0,disableSelectionOnClick:!0}))}var T=n(128),U=n.n(T);var G=function(){var e,t=Object(a.useState)(""),n=Object(u.a)(t,2),i=(n[0],n[1],Object(a.useState)(0)),h=Object(u.a)(i,2),g=(h[0],h[1]),w=Object(a.useState)({rows:[]}),b=Object(u.a)(w,2),y=b[0],E=b[1];y&&!(null===(e=y.rows)||void 0===e?void 0:e.length)&&U.a.getItem("initial-data").then((function(e){e&&E(e)}));var x=function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=W(Object(s.a)({},e)),E(e),U.a.setItem("initial-data",e)},P=function(e){!function(e){var t=R(e);E(t),console.log(t),Promise.all(t.rows.map((function(e){return e.metadata}))).then((function(e){e.forEach((function(e){t[e.fileId].metadata=e})),x(t),console.log("promise resolved",t)}))}(Array.from(e.target.files))},j=Object(a.useState)("Select file & click start"),k=Object(u.a)(j,2),O=(k[0],k[1],Object(d.createFFmpeg)({log:!1,logger:function(e){var t=e.type,n=e.message;"use ffmpeg.wasm v0.10.0"!==n&&console.log(t,n)}})),N=function(){var e=Object(c.a)(l.a.mark((function e(){var t,n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=Object(s.a)({},y),n=0;n<t.rows.length;)t[t.rows[n].id].processed={loaded:!1},n++;E(t,!1),a=0;case 4:if(!(a<t.rows.length)){e.next=12;break}return e.next=7,S(t.rows[a]);case 7:r=e.sent,t[t.rows[a].id].processed={result:r,loaded:!0},a++;case 10:e.next=4;break;case 12:x(t);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=[],S=function(){var e=Object(c.a)(l.a.mark((function e(t){var n,a,r,i,c,s,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,console.log("Loading ffmpeg-core.js"),O.isLoaded()){e.next=5;break}return e.next=5,O.load();case 5:return O.setProgress((function(e){var t=e.ratio;g(100*t)})),console.log("Start transcoding"),a=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!(t.length<=0)){var a=n+"/"+t.shift();F.includes(a)||(O.FS("mkdir",a),F.push(a),console.log(a,"created"),t.length>0&&e(t,a),console.log(a+" created"))}},r=n.relativePath.replace("/"+n.fileName,""),console.log(r),a(r.split("/")),e.t0=O,e.t1="/"+n.relativePath,e.next=15,Object(d.fetchFile)(n.file);case 15:return e.t2=e.sent,e.t0.FS.call(e.t0,"writeFile",e.t1,e.t2),console.log("/"+n.relativePath),i="-i ".concat(n.relativePath," -q:a 0 -af silenceremove=1:0:-50dB:0:0:-1:0:-50dB ").concat(n.relativePath.replace(n.fileName,"processed_"+n.fileName)),e.next=21,O.run.apply(O,Object(o.a)(i.split(" ")));case 21:return console.log("Complete transcoding"),e.next=24,O.FS("readFile",n.relativePath.replace(n.fileName,"processed_"+n.fileName));case 24:return c=e.sent,s=new File([c.buffer],"processed_"+n.fileName,{type:n.file.type,lastModified:n.file.lastModified,webkitRelativePath:n.relativePath.replace(n.fileName,"trimmed"+n.fileName)}),e.next=28,C(s,t.id);case 28:return u=e.sent,e.abrupt("return",{file:s,metadata:u});case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t){return new Promise((function(n,a){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){var e=new Audio(r.result);e.preload="metadata",e.onloadedmetadata=function(){n({data:r.result,duration:e.duration,fileId:t})}},r.onerror=function(e){return a(e)}}))},R=function(e){var t=function(e){return e.filter((function(e){if("."!==e.name[0]&&e instanceof Blob)return e})).map((function(e){return{file:e,id:e.webkitRelativePath,fileName:e.name,relativePath:e.webkitRelativePath,type:e.type,metadata:C(e,e.webkitRelativePath)}}))}(e),n={};return t.forEach((function(e){n[e.id]=e})),n.rows=Object.values(n),n},W=function(e){return delete e.rows,e.rows=Object.values(e),e},A=function(){return r.a.createElement(f.a,{container:!0,justifyContent:"center",alignItems:"center",height:"100%"},r.a.createElement(m.a,{badgeContent:y.rows.length,color:"primary",max:9999},r.a.createElement(p.a,{variant:y.rows.length?"outlined":"contained",component:"label"},y.rows.length?"Reupload folder":"Upload folder",r.a.createElement(v.a,{style:{display:"none"},onChange:P,inputProps:{webkitdirectory:"true"},type:"file"}))),r.a.createElement(p.a,{onClick:N},"Encode All"))};return r.a.createElement("div",{className:"App"},r.a.createElement(f.a,{container:!0,direction:"column",alignItems:"center",spacing:2},r.a.createElement(f.a,{item:!0}),r.a.createElement(f.a,{item:!0},r.a.createElement(A,null)),r.a.createElement(f.a,{item:!0,sx:{width:"100%"}},r.a.createElement(B,{rows:y.rows}))))},M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var H=n(157),J=document.getElementById("root");Object(H.createRoot)(J).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(G,null))),function(e){if("serviceWorker"in navigator){if(new URL("/react-ffmpeg",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/react-ffmpeg","/service-worker.js");M?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):_(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):_(t,e)}))}}()}},[[183,1,2]]]);
//# sourceMappingURL=main.16a29b72.chunk.js.map